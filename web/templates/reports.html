{% extends "base.html" %}

{% block title %}Reports - Application Rationalization Tool{% endblock %}

{% block page_title %}Reports & Exports{% endblock %}
{% block page_subtitle %}Generate and download portfolio reports{% endblock %}

{% block content %}
<!-- Export Options Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
    <!-- CSV Export Card -->
    <div class="stat-card bg-white rounded-xl shadow-md p-6 border-t-4 border-green-500">
        <div class="flex items-center mb-4">
            <div class="bg-green-100 rounded-lg p-3 mr-4">
                <i class="fas fa-file-csv text-3xl text-green-600"></i>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-800">CSV Export</h3>
                <p class="text-sm text-gray-500">Raw data format</p>
            </div>
        </div>
        <p class="text-sm text-gray-600 mb-4">
            Download the complete application portfolio data in CSV format for custom analysis and reporting.
        </p>
        <div class="space-y-2 text-xs text-gray-500 mb-4">
            <div class="flex items-center">
                <i class="fas fa-check text-green-600 mr-2"></i>
                <span>All application data</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-green-600 mr-2"></i>
                <span>Scores and recommendations</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-green-600 mr-2"></i>
                <span>Easy to import into other tools</span>
            </div>
        </div>
        <a href="/api/export/csv" download class="block w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-center font-medium">
            <i class="fas fa-download mr-2"></i>Download CSV
        </a>
    </div>

    <!-- Excel Export Card -->
    <div class="stat-card bg-white rounded-xl shadow-md p-6 border-t-4 border-blue-500">
        <div class="flex items-center mb-4">
            <div class="bg-blue-100 rounded-lg p-3 mr-4">
                <i class="fas fa-file-excel text-3xl text-blue-600"></i>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-800">Excel Report</h3>
                <p class="text-sm text-gray-500">Formatted workbook</p>
            </div>
        </div>
        <p class="text-sm text-gray-600 mb-4">
            Download a formatted Excel workbook with multiple sheets including data, charts, and analysis.
        </p>
        <div class="space-y-2 text-xs text-gray-500 mb-4">
            <div class="flex items-center">
                <i class="fas fa-check text-blue-600 mr-2"></i>
                <span>Multiple worksheets</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-blue-600 mr-2"></i>
                <span>Formatted tables and charts</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-blue-600 mr-2"></i>
                <span>Ready for presentations</span>
            </div>
        </div>
        <a href="/api/export/excel" download class="block w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-center font-medium">
            <i class="fas fa-download mr-2"></i>Download Excel
        </a>
    </div>

    <!-- PDF Report Card -->
    <div class="stat-card bg-white rounded-xl shadow-md p-6 border-t-4 border-red-500">
        <div class="flex items-center mb-4">
            <div class="bg-red-100 rounded-lg p-3 mr-4">
                <i class="fas fa-file-pdf text-3xl text-red-600"></i>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-800">PDF Report</h3>
                <p class="text-sm text-gray-500">Executive summary</p>
            </div>
        </div>
        <p class="text-sm text-gray-600 mb-4">
            Generate a comprehensive PDF report with executive summary, charts, and detailed recommendations.
        </p>
        <div class="space-y-2 text-xs text-gray-500 mb-4">
            <div class="flex items-center">
                <i class="fas fa-check text-red-600 mr-2"></i>
                <span>Executive-ready format</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-red-600 mr-2"></i>
                <span>Charts and visualizations</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-red-600 mr-2"></i>
                <span>Professional layout</span>
            </div>
        </div>
        <a href="/api/reports/export/executive_summary/pdf" download class="block w-full px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-center font-medium">
            <i class="fas fa-download mr-2"></i>Download PDF
        </a>
    </div>

    <!-- PowerPoint Export Card -->
    <div class="stat-card bg-white rounded-xl shadow-md p-6 border-t-4 border-orange-500">
        <div class="flex items-center mb-4">
            <div class="bg-orange-100 rounded-lg p-3 mr-4">
                <i class="fas fa-file-powerpoint text-3xl text-orange-600"></i>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-800">PowerPoint</h3>
                <p class="text-sm text-gray-500">Presentation deck</p>
            </div>
        </div>
        <p class="text-sm text-gray-600 mb-4">
            Auto-generate a PowerPoint presentation with executive slides, charts, and recommendations.
        </p>
        <div class="space-y-2 text-xs text-gray-500 mb-4">
            <div class="flex items-center">
                <i class="fas fa-check text-orange-600 mr-2"></i>
                <span>7 professional slides</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-orange-600 mr-2"></i>
                <span>Embedded charts and data</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-orange-600 mr-2"></i>
                <span>Board-ready presentation</span>
            </div>
        </div>
        <a href="/api/reports/export/executive_summary/powerpoint" download class="block w-full px-4 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition text-center font-medium">
            <i class="fas fa-download mr-2"></i>Download PowerPoint
        </a>
    </div>

    <!-- Power BI Card -->
    <div class="stat-card bg-white rounded-xl shadow-md p-6 border-t-4 border-yellow-500">
        <div class="flex items-center mb-4">
            <div class="bg-yellow-100 rounded-lg p-3 mr-4">
                <i class="fas fa-chart-line text-3xl text-yellow-600"></i>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-800">Power BI</h3>
                <p class="text-sm text-gray-500">BI integration</p>
            </div>
        </div>
        <p class="text-sm text-gray-600 mb-4">
            Export data in a format optimized for Microsoft Power BI with pre-configured data model and relationships.
        </p>
        <div class="space-y-2 text-xs text-gray-500 mb-4">
            <div class="flex items-center">
                <i class="fas fa-check text-yellow-600 mr-2"></i>
                <span>Power BI template included</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-yellow-600 mr-2"></i>
                <span>Pre-built dashboards</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-yellow-600 mr-2"></i>
                <span>Interactive visualizations</span>
            </div>
        </div>
        <button onclick="showComingSoon('Power BI Export')" class="block w-full px-4 py-3 bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition text-center font-medium">
            <i class="fas fa-clock mr-2"></i>Coming Soon
        </button>
    </div>

    <!-- Tableau Card -->
    <div class="stat-card bg-white rounded-xl shadow-md p-6 border-t-4 border-purple-500">
        <div class="flex items-center mb-4">
            <div class="bg-purple-100 rounded-lg p-3 mr-4">
                <i class="fas fa-chart-area text-3xl text-purple-600"></i>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-800">Tableau</h3>
                <p class="text-sm text-gray-500">BI integration</p>
            </div>
        </div>
        <p class="text-sm text-gray-600 mb-4">
            Export data in Tableau-compatible format with pre-built workbook and dashboard templates.
        </p>
        <div class="space-y-2 text-xs text-gray-500 mb-4">
            <div class="flex items-center">
                <i class="fas fa-check text-purple-600 mr-2"></i>
                <span>Tableau workbook included</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-purple-600 mr-2"></i>
                <span>Custom visualizations</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-purple-600 mr-2"></i>
                <span>Drill-down capabilities</span>
            </div>
        </div>
        <button onclick="showComingSoon('Tableau Export')" class="block w-full px-4 py-3 bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition text-center font-medium">
            <i class="fas fa-clock mr-2"></i>Coming Soon
        </button>
    </div>

    <!-- API Access Card -->
    <div class="stat-card bg-white rounded-xl shadow-md p-6 border-t-4 border-indigo-500">
        <div class="flex items-center mb-4">
            <div class="bg-indigo-100 rounded-lg p-3 mr-4">
                <i class="fas fa-code text-3xl text-indigo-600"></i>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-800">API Access</h3>
                <p class="text-sm text-gray-500">Programmatic export</p>
            </div>
        </div>
        <p class="text-sm text-gray-600 mb-4">
            Access application portfolio data programmatically via REST API for integration with other systems.
        </p>
        <div class="space-y-2 text-xs text-gray-500 mb-4">
            <div class="flex items-center">
                <i class="fas fa-check text-indigo-600 mr-2"></i>
                <span>RESTful API endpoints</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-indigo-600 mr-2"></i>
                <span>JSON and XML formats</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-check text-indigo-600 mr-2"></i>
                <span>Authentication included</span>
            </div>
        </div>
        <button onclick="showComingSoon('API Access')" class="block w-full px-4 py-3 bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition text-center font-medium">
            <i class="fas fa-clock mr-2"></i>Coming Soon
        </button>
    </div>
</div>

<!-- Report Configuration Section -->
<div class="bg-white rounded-xl shadow-md p-6 mb-8">
    <h3 class="text-lg font-semibold text-gray-800 mb-4">
        <i class="fas fa-cog text-gray-600 mr-2"></i>
        Report Configuration
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
                Include in Report
            </label>
            <div class="space-y-2">
                <label class="flex items-center">
                    <input type="checkbox" checked class="form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                    <span class="ml-3 text-sm text-gray-700">Executive Summary</span>
                </label>
                <label class="flex items-center">
                    <input type="checkbox" checked class="form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                    <span class="ml-3 text-sm text-gray-700">KPI Metrics</span>
                </label>
                <label class="flex items-center">
                    <input type="checkbox" checked class="form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                    <span class="ml-3 text-sm text-gray-700">Application Details</span>
                </label>
                <label class="flex items-center">
                    <input type="checkbox" checked class="form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                    <span class="ml-3 text-sm text-gray-700">Visualizations & Charts</span>
                </label>
                <label class="flex items-center">
                    <input type="checkbox" checked class="form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                    <span class="ml-3 text-sm text-gray-700">Recommendations</span>
                </label>
            </div>
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
                Filter Applications
            </label>
            <div class="space-y-3">
                <div>
                    <label class="block text-xs text-gray-600 mb-1">By Recommendation</label>
                    <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm">
                        <option value="">All Recommendations</option>
                        <option value="retire">Retire</option>
                        <option value="invest">Invest</option>
                        <option value="maintain">Maintain</option>
                        <option value="migrate">Migrate</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xs text-gray-600 mb-1">By TIME Category</label>
                    <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm">
                        <option value="">All Categories</option>
                        <option value="invest">Invest</option>
                        <option value="tolerate">Tolerate</option>
                        <option value="migrate">Migrate</option>
                        <option value="eliminate">Eliminate</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scheduled Reports Section -->
<div class="bg-white rounded-xl shadow-md p-6">
    <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-800">
            <i class="fas fa-calendar-alt text-blue-600 mr-2"></i>
            Scheduled Reports
        </h3>
        <button onclick="showComingSoon('Scheduled Reports')" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm font-medium">
            <i class="fas fa-plus mr-2"></i>Create Schedule
        </button>
    </div>
    <div class="text-center py-8">
        <i class="fas fa-calendar-times text-5xl text-gray-300 mb-3"></i>
        <p class="text-gray-500">No scheduled reports configured</p>
        <p class="text-sm text-gray-400 mt-2">Set up automated report generation and delivery</p>
    </div>
</div>

<!-- Coming Soon Modal -->
<div id="comingSoonModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md mx-4">
        <div class="text-center">
            <div class="mb-4">
                <i class="fas fa-rocket text-6xl text-blue-600"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-3">Coming Soon!</h3>
            <p class="text-gray-600 mb-6" id="featureName">This feature is currently under development.</p>
            <p class="text-sm text-gray-500 mb-6">
                We're working hard to bring you this feature. Check back soon for updates!
            </p>
            <button onclick="closeModal()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium">
                <i class="fas fa-times mr-2"></i>Close
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
function showComingSoon(feature) {
    const modal = document.getElementById('comingSoonModal');
    const featureName = document.getElementById('featureName');
    featureName.textContent = feature + ' is currently under development.';
    modal.classList.remove('hidden');
    modal.classList.add('flex');
}

function closeModal() {
    const modal = document.getElementById('comingSoonModal');
    modal.classList.add('hidden');
    modal.classList.remove('flex');
}

// Close modal when clicking outside
document.getElementById('comingSoonModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeModal();
    }
});

// Close modal with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeModal();
    }
});
{% endblock %}
